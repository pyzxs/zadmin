2024-12-09 21:12:39.505 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/ http/1.1' 404utf-8 b'22' 0.0
2024-12-09 21:12:39.813 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/favicon.ico http/1.1' 404utf-8 b'22' 0.0010006427764892578
2024-12-09 21:12:43.702 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0009992122650146484
2024-12-09 21:14:47.863 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0009989738464355469
2024-12-09 21:15:01.943 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'1811' 0.08495306968688965
2024-12-09 21:25:51.529 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0010044574737548828
2024-12-09 21:26:13.345 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'2295' 0.20795774459838867
2024-12-09 21:26:18.942 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0
2024-12-09 21:26:31.149 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.000942230224609375
2024-12-09 21:26:31.420 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'2295' 0.0010004043579101562
2024-12-09 21:26:53.575 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0049970149993896484
2024-12-09 21:26:54.494 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'2836' 0.07293009757995605
2024-12-09 21:27:16.552 | ERROR    | core.exception:all_exception_handler:140 - 'RegisterUser' object is not subscriptable
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x0000020C0C6F9550>
  |     └ <anyio._backends._asyncio.Event object at 0x0000020C0C6ED970>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020C0C695C10>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020C0C6976A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020C0C695C10>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x0000020C0C53D430>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000020C0C6F9550>
    |     └ <anyio._backends._asyncio.Event object at 0x0000020C0C6ED970>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000020C0C79DD40>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError("'RegisterUser' object is not subscriptable")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000020C0C6E0660>
    |     └ <contextlib._GeneratorContextManager object at 0x0000020C0C6ED880>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C695040>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6EDE50>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000020C0C68B5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6EDE50>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C695040>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError("'RegisterUser' object is not subscriptable")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C702F70>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C702B80>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000020C0C6F9550>
    |     └ <anyio._backends._asyncio.Event object at 0x0000020C0C6ED100>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000020C0C534BC0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError("'RegisterUser' object is not subscriptable")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000020C0C6E0E40>
    |     └ <contextlib._GeneratorContextManager object at 0x0000020C0C6ED580>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C70EDC0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6ED5B0>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000020C0C68B550>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6ED5B0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C70EDC0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError("'RegisterUser' object is not subscriptable")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C70E0D0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020C0C697670>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C70E0D0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x0000020C0C716220>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020C0C697670>
    |           └ <function wrap_app_handling_exceptions at 0x0000020C0B2BAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>>
    |           └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x0000020C0B2E70D0>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x0000020C0C695EE0>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x0000020C0C716A60>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000020C0C70E4C0>
    |           └ <function wrap_app_handling_exceptions at 0x0000020C0B2BAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70E430>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x0000020C0C70E4C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x0000020C0C716A60>
    |                      └ <function get_request_handler.<locals>.app at 0x0000020C0C695F70>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x0000020C0B2ECCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>, 'req': RegisterUser(mobile='18611570121', password='123...
    |                  │         └ <function register_user at 0x0000020C0C527A60>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    |     await user.create(db, req)
    |           │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
    |           │    │      └ <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>
    |           │    └ <function create at 0x0000020C0C512790>
    |           └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>
    |
    |   File "E:\workspace\zadmin\apps\user\services\user.py", line 13, in create
    |     exists = db.query(User).filter_by(mobile=req['mobile']).unique()
    |              │  │     │                      └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
    |              │  │     └ <class 'apps.user.models.User'>
    |              │  └ <function Session.query at 0x0000020C0BE4D3A0>
    |              └ <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>
    |
    | TypeError: 'RegisterUser' object is not subscriptable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020C0C...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020C0C6976A0>
          └ <fastapi.applications.FastAPI object at 0x0000020C0C56B670>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020C0C695C10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000020C0C6976A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000020C0C695C10>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000020C0C53D430>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000020...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000020C0C697550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000020C0C6F9550>
    └ <anyio._backends._asyncio.Event object at 0x0000020C0C6ED970>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000020C0C79DD40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError("'RegisterUser' object is not subscriptable")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000020C0C6E0660>
    └ <contextlib._GeneratorContextManager object at 0x0000020C0C6ED880>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C695040>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6EDE50>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000020C0C68B5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6EDE50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C695040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError("'RegisterUser' object is not subscriptable")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C702F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C702B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6976D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000020C0C6F9550>
    └ <anyio._backends._asyncio.Event object at 0x0000020C0C6ED100>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000020C0C534BC0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError("'RegisterUser' object is not subscriptable")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000020C0C6E0E40>
    └ <contextlib._GeneratorContextManager object at 0x0000020C0C6ED580>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C70EDC0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6ED5B0>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000020C0C68B550>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000020C0C6ED5B0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000020C0C70EDC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError("'RegisterUser' object is not subscriptable")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C70E0D0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020C0C697670>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000020C0C6977C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000020C0C70E0D0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000020C0C716220>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000020C0C697670>
          └ <function wrap_app_handling_exceptions at 0x0000020C0B2BAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>>
          └ <fastapi.routing.APIRouter object at 0x0000020C0C677BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x0000020C0B2E70D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000020C0C695EE0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70EF70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000020C0C716A60>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000020C0C70E4C0>
          └ <function wrap_app_handling_exceptions at 0x0000020C0B2BAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000020C0C70E430>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000020C0C70E160>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000020C0C70E4C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000020C0C716A60>
                     └ <function get_request_handler.<locals>.app at 0x0000020C0C695F70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000020C0B2ECCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x0000020C0C527A60>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>
          │    └ <function create at 0x0000020C0C512790>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 13, in create
    exists = db.query(User).filter_by(mobile=req['mobile']).unique()
             │  │     │                      └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
             │  │     └ <class 'apps.user.models.User'>
             │  └ <function Session.query at 0x0000020C0BE4D3A0>
             └ <sqlalchemy.orm.session.Session object at 0x0000020C0C726430>

TypeError: 'RegisterUser' object is not subscriptable
2024-12-09 21:28:37.349 | ERROR    | core.exception:all_exception_handler:140 - 'Query' object has no attribute 'unique'
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x00000195BF2085E0>
  |     └ <anyio._backends._asyncio.Event object at 0x00000195BF1AF7C0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000195BF1A5AF0>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000195BF1A6520>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000195BF1A5AF0>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x00000195BF04C4C0>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x00000195BF2085E0>
    |     └ <anyio._backends._asyncio.Event object at 0x00000195BF1AF7C0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x00000195BF21FE40>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'Query' object has no attribute 'unique'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x00000195BF19BE40>
    |     └ <contextlib._GeneratorContextManager object at 0x00000195BF1AF8B0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF1A5A60>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000195BF1AF8E0>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x00000195BF19A670>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x00000195BF1AF8E0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF1A5A60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'Query' object has no attribute 'unique'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF19A550>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF1A5430>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x00000195BF2085E0>
    |     └ <anyio._backends._asyncio.Event object at 0x00000195BF2010A0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x00000195BF21F040>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'Query' object has no attribute 'unique'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x00000195BF1F1660>
    |     └ <contextlib._GeneratorContextManager object at 0x00000195BF201070>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF212AF0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000195BF2013A0>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x00000195BF19A5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x00000195BF2013A0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF212AF0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'Query' object has no attribute 'unique'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF212CA0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000195BF1A6610>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF212CA0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x00000195BF1FDCD0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000195BF1A6610>
    |           └ <function wrap_app_handling_exceptions at 0x00000195BCDFAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000195BF186BB0>>
    |           └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x00000195BCE280D0>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x00000195BF1A5E50>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x00000195BF1FD550>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000195BF21E040>
    |           └ <function wrap_app_handling_exceptions at 0x00000195BCDFAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF21E0D0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x00000195BF21E040>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x00000195BF1FD550>
    |                      └ <function get_request_handler.<locals>.app at 0x00000195BF1A5F70>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x00000195BCE2CCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>, 'req': RegisterUser(mobile='18611570121', password='123...
    |                  │         └ <function register_user at 0x00000195BF034AF0>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    |     await user.create(db, req)
    |           │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
    |           │    │      └ <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>
    |           │    └ <function create at 0x00000195BF021790>
    |           └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>
    |
    |   File "E:\workspace\zadmin\apps\user\services\user.py", line 14, in create
    |     exists = db.query(User).filter_by(mobile=req['mobile']).unique()
    |              │  │     │                      └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}
    |              │  │     └ <class 'apps.user.models.User'>
    |              │  └ <function Session.query at 0x00000195BE95D3A0>
    |              └ <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>
    |
    | AttributeError: 'Query' object has no attribute 'unique'
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000195BF...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000195BF1A6520>
          └ <fastapi.applications.FastAPI object at 0x00000195BF07AAC0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000195BF1A5AF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000195BF1A6520>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000195BF1A5AF0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x00000195BF04C4C0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000195BF1A6490>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x00000195BF2085E0>
    └ <anyio._backends._asyncio.Event object at 0x00000195BF1AF7C0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x00000195BF21FE40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'Query' object has no attribute 'unique'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x00000195BF19BE40>
    └ <contextlib._GeneratorContextManager object at 0x00000195BF1AF8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF1A5A60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000195BF1AF8E0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x00000195BF19A670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000195BF1AF8E0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF1A5A60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'Query' object has no attribute 'unique'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF19A550>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF1A5430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6760>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x00000195BF2085E0>
    └ <anyio._backends._asyncio.Event object at 0x00000195BF2010A0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x00000195BF21F040>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'Query' object has no attribute 'unique'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x00000195BF1F1660>
    └ <contextlib._GeneratorContextManager object at 0x00000195BF201070>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF212AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x00000195BF2013A0>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x00000195BF19A5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x00000195BF2013A0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x00000195BF212AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'Query' object has no attribute 'unique'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF212CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000195BF1A6610>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x00000195BF1A6640>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x00000195BF212CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x00000195BF1FDCD0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000195BF1A6610>
          └ <function wrap_app_handling_exceptions at 0x00000195BCDFAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000195BF186BB0>>
          └ <fastapi.routing.APIRouter object at 0x00000195BF186BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x00000195BCE280D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x00000195BF1A5E50>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF212F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x00000195BF1FD550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000195BF21E040>
          └ <function wrap_app_handling_exceptions at 0x00000195BCDFAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000195BF21E0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x00000195BF212B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x00000195BF21E040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x00000195BF1FD550>
                     └ <function get_request_handler.<locals>.app at 0x00000195BF1A5F70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000195BCE2CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x00000195BF034AF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>
          │    └ <function create at 0x00000195BF021790>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 14, in create
    exists = db.query(User).filter_by(mobile=req['mobile']).unique()
             │  │     │                      └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}
             │  │     └ <class 'apps.user.models.User'>
             │  └ <function Session.query at 0x00000195BE95D3A0>
             └ <sqlalchemy.orm.session.Session object at 0x00000195BF1FD070>

AttributeError: 'Query' object has no attribute 'unique'
2024-12-09 21:29:08.418 | ERROR    | core.exception:all_exception_handler:140 - bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x0000019F190585E0>
  |     └ <anyio._backends._asyncio.Event object at 0x0000019F18FFF7C0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019F18FF5AF0>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F18FF7520>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019F18FF5AF0>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x0000019F18E9C4C0>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000019F190585E0>
    |     └ <anyio._backends._asyncio.Event object at 0x0000019F18FFF7C0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000019F19125F80>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [MissingBackendError("bcrypt: no backends available -- recommend you instal...
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000019F18FEBE40>
    |     └ <contextlib._GeneratorContextManager object at 0x0000019F18FFF8B0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F18FF5A60>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019F18FFF8E0>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000019F18FEA670>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000019F18FFF8E0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F18FF5A60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F18FEA550>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F18FF5430>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000019F190585E0>
    |     └ <anyio._backends._asyncio.Event object at 0x0000019F190510A0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000019F18E8CB00>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [MissingBackendError("bcrypt: no backends available -- recommend you instal...
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000019F19041660>
    |     └ <contextlib._GeneratorContextManager object at 0x0000019F19051070>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F19062AF0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019F190513A0>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000019F18FEA5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000019F190513A0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F19062AF0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F19062CA0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F18FF7610>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F19062CA0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x0000019F1904DCD0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F18FF7610>
    |           └ <function wrap_app_handling_exceptions at 0x0000019F17C1AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>>
    |           └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x0000019F17C480D0>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x0000019F18FF5E50>
    |           └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x0000019F1904D550>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000019F1906E040>
    |           └ <function wrap_app_handling_exceptions at 0x0000019F17C1AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F1906E0D0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x0000019F1906E040>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x0000019F1904D550>
    |                      └ <function get_request_handler.<locals>.app at 0x0000019F18FF5F70>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x0000019F17C4CCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000019F1904D070>, 'req': RegisterUser(mobile='18611570121', password='123...
    |                  │         └ <function register_user at 0x0000019F18E84AF0>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    |     await user.create(db, req)
    |           │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
    |           │    │      └ <sqlalchemy.orm.session.Session object at 0x0000019F1904D070>
    |           │    └ <function create at 0x0000019F18E71790>
    |           └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>
    |
    |   File "E:\workspace\zadmin\apps\user\services\user.py", line 18, in create
    |     req['password'] = User.get_password_hash(req['password'])
    |     │                 │    │                 └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}
    |     │                 │    └ <staticmethod object at 0x0000019F18DC8160>
    |     │                 └ <class 'apps.user.models.User'>
    |     └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}
    |
    |   File "E:\workspace\zadmin\apps\user\models.py", line 133, in get_password_hash
    |     return pwd_context.hash(password)
    |            │           │    └ '123456'
    |            │           └ <function CryptContext.hash at 0x0000019F18B0CEE0>
    |            └ <CryptContext at 0x19f188970a0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\context.py", line 2258, in hash
    |     return record.hash(secret, **kwds)
    |            │      │    │         └ {}
    |            │      │    └ '123456'
    |            │      └ <classmethod object at 0x0000019F18AFC700>
    |            └ <class 'passlib.handlers.bcrypt.<customized bcrypt hasher>'>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 779, in hash
    |     self.checksum = self._calc_checksum(secret)
    |     │    │          │    │              └ '123456'
    |     │    │          │    └ <function _NoBackend._calc_checksum at 0x0000019F18D5A670>
    |     │    │          └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>
    |     │    └ None
    |     └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\handlers\bcrypt.py", line 591, in _calc_checksum
    |     self._stub_requires_backend()
    |     │    └ <classmethod object at 0x0000019F18B06820>
    |     └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2254, in _stub_requires_backend
    |     cls.set_backend()
    |     │   └ <classmethod object at 0x0000019F18B06760>
    |     └ <class 'passlib.handlers.bcrypt.<customized bcrypt hasher>'>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2156, in set_backend
    |     return owner.set_backend(name, dryrun=dryrun)
    |            │     │           │            └ False
    |            │     │           └ 'any'
    |            │     └ <classmethod object at 0x0000019F18B06760>
    |            └ <class 'passlib.handlers.bcrypt.bcrypt'>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2176, in set_backend
    |     raise default_error
    |           └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")
    |
    | passlib.exc.MissingBackendError: bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019F18...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F18FF7520>
          └ <fastapi.applications.FastAPI object at 0x0000019F18ECAAC0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019F18FF5AF0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019F18FF7520>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019F18FF5AF0>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000019F18E9C4C0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019F18FF7490>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000019F190585E0>
    └ <anyio._backends._asyncio.Event object at 0x0000019F18FFF7C0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000019F19125F80>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [MissingBackendError("bcrypt: no backends available -- recommend you instal...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000019F18FEBE40>
    └ <contextlib._GeneratorContextManager object at 0x0000019F18FFF8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F18FF5A60>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019F18FFF8E0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000019F18FEA670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000019F18FFF8E0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F18FF5A60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F18FEA550>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F18FF5430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7760>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000019F190585E0>
    └ <anyio._backends._asyncio.Event object at 0x0000019F190510A0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000019F18E8CB00>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [MissingBackendError("bcrypt: no backends available -- recommend you instal...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000019F19041660>
    └ <contextlib._GeneratorContextManager object at 0x0000019F19051070>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F19062AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019F190513A0>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000019F18FEA5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000019F190513A0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019F19062AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F19062CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F18FF7610>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019F18FF7640>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019F19062CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000019F1904DCD0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019F18FF7610>
          └ <function wrap_app_handling_exceptions at 0x0000019F17C1AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>>
          └ <fastapi.routing.APIRouter object at 0x0000019F18FD6BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x0000019F17C480D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000019F18FF5E50>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F19062F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000019F1904D550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000019F1906E040>
          └ <function wrap_app_handling_exceptions at 0x0000019F17C1AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019F1906E0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019F19062B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000019F1906E040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000019F1904D550>
                     └ <function get_request_handler.<locals>.app at 0x0000019F18FF5F70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000019F17C4CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000019F1904D070>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x0000019F18E84AF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x0000019F1904D070>
          │    └ <function create at 0x0000019F18E71790>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 18, in create
    req['password'] = User.get_password_hash(req['password'])
    │                 │    │                 └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}
    │                 │    └ <staticmethod object at 0x0000019F18DC8160>
    │                 └ <class 'apps.user.models.User'>
    └ {'mobile': '18611570121', 'password': '123456', 'name': 'laozhu', 'nickname': 'laozhu', 'disabled': False}

  File "E:\workspace\zadmin\apps\user\models.py", line 133, in get_password_hash
    return pwd_context.hash(password)
           │           │    └ '123456'
           │           └ <function CryptContext.hash at 0x0000019F18B0CEE0>
           └ <CryptContext at 0x19f188970a0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\context.py", line 2258, in hash
    return record.hash(secret, **kwds)
           │      │    │         └ {}
           │      │    └ '123456'
           │      └ <classmethod object at 0x0000019F18AFC700>
           └ <class 'passlib.handlers.bcrypt.<customized bcrypt hasher>'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 779, in hash
    self.checksum = self._calc_checksum(secret)
    │    │          │    │              └ '123456'
    │    │          │    └ <function _NoBackend._calc_checksum at 0x0000019F18D5A670>
    │    │          └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>
    │    └ None
    └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\handlers\bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    │    └ <classmethod object at 0x0000019F18B06820>
    └ <passlib.handlers.bcrypt.<customized bcrypt hasher> object at 0x0000019F190D4220>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    │   └ <classmethod object at 0x0000019F18B06760>
    └ <class 'passlib.handlers.bcrypt.<customized bcrypt hasher>'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           │     │           │            └ False
           │     │           └ 'any'
           │     └ <classmethod object at 0x0000019F18B06760>
           └ <class 'passlib.handlers.bcrypt.bcrypt'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\passlib\utils\handlers.py", line 2176, in set_backend
    raise default_error
          └ MissingBackendError("bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')")

passlib.exc.MissingBackendError: bcrypt: no backends available -- recommend you install one (e.g. 'pip install bcrypt')
2024-12-09 21:32:38.228 | ERROR    | core.exception:all_exception_handler:140 - (pymysql.err.IntegrityError) (1048, "Column 'last_ip' cannot be null")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(last_ip)s, %(last_login)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$b9vg1D/7tlLG.JOBXSaoS.mVnQGC4zErmlXfhzn0RsUCpcytCInka', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'last_ip': None, 'last_login': None, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001A6D65CA1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000001A6D6D05F10>
    └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$b9vg1D/7tlLG.JOBXSaoS.mVnQGC4zErmlXfhzn0RsUCpcytCInka', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
    │      └ <function Cursor.execute at 0x000001A6D6D51D30>
    └ <pymysql.cursors.Cursor object at 0x000001A6D720ACA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
             │    └ <function Cursor._query at 0x000001A6D6D5B1F0>
             └ <pymysql.cursors.Cursor object at 0x000001A6D720ACA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
    │    └ <function Connection.query at 0x000001A6D6D65280>
    └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000001A6D6D65940>
    │    │                └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000001A6D6D69160>
    └ <pymysql.connections.MySQLResult object at 0x000001A6D71B51C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000001A6D71B51C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000001A6D6D64E50>
    └ <pymysql.protocol.MysqlPacket object at 0x000001A6D720A4F0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000001A6D720A4F0>
    │   └ <function raise_mysql_exception at 0x000001A6D6D035E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Column 'last_ip' cannot be null"
          │          └ 1048
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1048, "Column 'last_ip' cannot be null")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A6D7...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001A6D70E11F0>
          └ <fastapi.applications.FastAPI object at 0x000001A6D6FAEAC0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6D70DEA60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A6D70E12E0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001A6D70E11F0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6D70DEA60>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x000001A6D6F6F670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A6D70E12E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001A6D70E12E0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13A0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A6D70E12E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001A6D713A5E0>
    └ <anyio._backends._asyncio.Event object at 0x000001A6D70E1EB0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001A6D7255600>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' ca...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001A6D71090B0>
    └ <contextlib._GeneratorContextManager object at 0x000001A6D70E1EE0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6D70CDB80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A6D70E1E80>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001A6D70CD670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13A0>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001A6D70E1E80>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6D70CDB80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' cannot be null")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A6D70DE670>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D70CDF70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13D0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001A6D713A5E0>
    └ <anyio._backends._asyncio.Event object at 0x000001A6D71300A0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001A6D7232300>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' ca...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001A6D7122890>
    └ <contextlib._GeneratorContextManager object at 0x000001A6D7130070>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6D7144AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A6D71300D0>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001A6D70CD5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13D0>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001A6D71300D0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6D7144AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' cannot be null")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A6D7144CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A6D70E14F0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A6D70E13D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A6D7144CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001A6D712D700>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001A6D70B9BB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A6D70E14F0>
          └ <function wrap_app_handling_exceptions at 0x000001A6D5CFAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D7144F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001A6D70B9BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D7144F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001A6D70B9BB0>>
          └ <fastapi.routing.APIRouter object at 0x000001A6D70B9BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D7144F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001A6D5D280D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D7144F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001A6D70DE790>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D7144F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001A6D712D6A0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001A6D714C040>
          └ <function wrap_app_handling_exceptions at 0x000001A6D5CFAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A6D714C0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6D7144B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001A6D714C040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001A6D712D6A0>
                     └ <function get_request_handler.<locals>.app at 0x000001A6D70DE700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001A6D5D2CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001A6D712D2E0>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x000001A6D6F6FAF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x000001A6D712D2E0>
          │    └ <function create at 0x000001A6D6F5B820>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 21, in create
    db.commit()
    │  └ <function Session.commit at 0x000001A6D688A9D0>
    └ <sqlalchemy.orm.session.Session object at 0x000001A6D712D2E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000001A6D6885C10>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71BF480>

  File "<string>", line 2, in commit

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71BF480>
                └ <function SessionTransaction.commit at 0x000001A6D6885B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000001A6D6885AF0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71BF480>

  File "<string>", line 2, in _prepare_impl

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71BF480>
                └ <function SessionTransaction._prepare_impl at 0x000001A6D68859D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000001A6D6891790>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001A6D712D2E0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71BF480>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001A6D6891940>
    └ <sqlalchemy.orm.session.Session object at 0x000001A6D712D2E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x000001A6D6885E50>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001A6D71CC840>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001A6D4B6DE40>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' cannot be null")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001A6D687CA60>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001A6D17CDC70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001A6D17CDC70>
    │   └ <function SaveUpdateAll.execute at 0x000001A6D687D3A0>
    └ SaveUpdateAll(Mapper[User(users)])

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001A6D68515E0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py'>
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\preloaded.py'>
    └ <module 'sqlalchemy.util' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x000001A6D685F160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x000001A6D650B160>
             └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001A6D71D7D90>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001A6D650B430>
           └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001A6D650B5E0>
          └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001A6D650B670>
           └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001A6D650B8B0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ IntegrityError(1048, "Column 'last_ip' cannot be null")
          │                    │              └ (<class 'pymysql.err.IntegrityError'>, IntegrityError(1048, "Column 'last_ip' cannot be null"), <traceback object at 0x000001...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(pymysql.err.IntegrityError) (1048, "Column \'last_ip\' cannot be null")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001A6D65CA1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000001A6D6D05F10>
    └ <sqlalchemy.engine.base.Connection object at 0x000001A6D71BE3A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$b9vg1D/7tlLG.JOBXSaoS.mVnQGC4zErmlXfhzn0RsUCpcytCInka', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
    │      └ <function Cursor.execute at 0x000001A6D6D51D30>
    └ <pymysql.cursors.Cursor object at 0x000001A6D720ACA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
             │    └ <function Cursor._query at 0x000001A6D6D5B1F0>
             └ <pymysql.cursors.Cursor object at 0x000001A6D720ACA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, del...
    │    └ <function Connection.query at 0x000001A6D6D65280>
    └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000001A6D6D65940>
    │    │                └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000001A6D6F5CA90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000001A6D6D69160>
    └ <pymysql.connections.MySQLResult object at 0x000001A6D71B51C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000001A6D71B51C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000001A6D6D64E50>
    └ <pymysql.protocol.MysqlPacket object at 0x000001A6D720A4F0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000001A6D720A4F0>
    │   └ <function raise_mysql_exception at 0x000001A6D6D035E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Column 'last_ip' cannot be null"
          │          └ 1048
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1048, "Column 'last_ip' cannot be null")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, last_ip, last_login, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(last_ip)s, %(last_login)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$b9vg1D/7tlLG.JOBXSaoS.mVnQGC4zErmlXfhzn0RsUCpcytCInka', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'last_ip': None, 'last_login': None, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-12-09 21:33:40.838 | ERROR    | core.exception:all_exception_handler:140 - (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$upm11Z3e1M1kmGdbJJfC6eHhrCgk.cx1VEGi1nmRL85BiSC45plve', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002708615A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000027086895F10>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$upm11Z3e1M1kmGdbJJfC6eHhrCgk.cx1VEGi1nmRL85BiSC45plve', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x00000270868E2D30>
    └ <pymysql.cursors.Cursor object at 0x0000027086D5ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x00000270868EB1F0>
             └ <pymysql.cursors.Cursor object at 0x0000027086D5ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x00000270868F5280>
    └ <pymysql.connections.Connection object at 0x0000027086AECC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000270868F5940>
    │    │                └ <pymysql.connections.Connection object at 0x0000027086AECC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000027086AECC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000270868F8160>
    └ <pymysql.connections.MySQLResult object at 0x0000027086CBF910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000027086CBF910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x00000270868F4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x0000027086D5A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000027086D5A8B0>
    │   └ <function raise_mysql_exception at 0x00000270868935E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

pymysql.err.OperationalError: (1364, "Field 'last_ip' doesn't have a default value")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000027086...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000027...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027086C71100>
          └ <fastapi.applications.FastAPI object at 0x0000027086B3E8E0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000027086C6DA60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000027...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000027086C710A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027086C71100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000027086C6DA60>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000027...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000027086AFD670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000027086C710A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000027086C710A0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000027...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71190>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000027086C710A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000027086CC95E0>
    └ <anyio._backends._asyncio.Event object at 0x0000027086C71CD0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000027086DD6C40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000027086C980B0>
    └ <contextlib._GeneratorContextManager object at 0x0000027086C71D00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000027086C5BB80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000027086C71CA0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000027086C5B670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71190>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000027086C71CA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000027086C5BB80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000027086C6D670>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086C5BF70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71310>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000027086CC95E0>
    └ <anyio._backends._asyncio.Event object at 0x0000027086CC1340>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000027086D92B40>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000027086CB1890>
    └ <contextlib._GeneratorContextManager object at 0x0000027086CC1310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000027086CD2AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000027086CC1370>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000027086C5B5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71310>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000027086CC1370>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000027086CD2AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000027086CD2CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027086C712E0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000027086C71310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000027086CD2CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000027086CBFEE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000027086C4ABB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027086C712E0>
          └ <function wrap_app_handling_exceptions at 0x000002708588AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CD2F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000027086C4ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CD2F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027086C4ABB0>>
          └ <fastapi.routing.APIRouter object at 0x0000027086C4ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CD2F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x00000270858B80D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CD2F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000027086C6D790>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CD2F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000027086CBF580>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000027086CDB040>
          └ <function wrap_app_handling_exceptions at 0x000002708588AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027086CDB0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000027086CD2B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000027086CDB040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000027086CBF580>
                     └ <function get_request_handler.<locals>.app at 0x0000027086C6D700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x00000270858BECA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000027086CBF790>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x0000027086AFDAF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x0000027086CBF790>
          │    └ <function create at 0x0000027086AE9820>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 21, in create
    db.commit()
    │  └ <function Session.commit at 0x000002708641A9D0>
    └ <sqlalchemy.orm.session.Session object at 0x0000027086CBF790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000027086415C10>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086B07540>

  File "<string>", line 2, in commit

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086B07540>
                └ <function SessionTransaction.commit at 0x0000027086415B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000027086415AF0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086B07540>

  File "<string>", line 2, in _prepare_impl

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086B07540>
                └ <function SessionTransaction._prepare_impl at 0x00000270864159D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000027086421790>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000027086CBF790>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086B07540>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000027086421940>
    └ <sqlalchemy.orm.session.Session object at 0x0000027086CBF790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x0000027086415E50>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027086D56600>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000027086DD6300>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000002708640CA60>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000027086D66E80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000027086D66E80>
    │   └ <function SaveUpdateAll.execute at 0x000002708640D3A0>
    └ SaveUpdateAll(Mapper[User(users)])

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x00000270863E15E0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py'>
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\preloaded.py'>
    └ <module 'sqlalchemy.util' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x00000270863EF160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x000002708609B160>
             └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x0000027086D66A60>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002708609B430>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002708609B5E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000002708609B670>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002708609B8B0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(1364, "Field 'last_ip' doesn't have a default value")
          │                    │              └ (<class 'pymysql.err.OperationalError'>, OperationalError(1364, "Field 'last_ip' doesn't have a default value"), <traceback o...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002708615A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000027086895F10>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027086D5A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$upm11Z3e1M1kmGdbJJfC6eHhrCgk.cx1VEGi1nmRL85BiSC45plve', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x00000270868E2D30>
    └ <pymysql.cursors.Cursor object at 0x0000027086D5ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x00000270868EB1F0>
             └ <pymysql.cursors.Cursor object at 0x0000027086D5ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x00000270868F5280>
    └ <pymysql.connections.Connection object at 0x0000027086AECC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x00000270868F5940>
    │    │                └ <pymysql.connections.Connection object at 0x0000027086AECC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000027086AECC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x00000270868F8160>
    └ <pymysql.connections.MySQLResult object at 0x0000027086CBF910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000027086CBF910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x00000270868F4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x0000027086D5A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000027086D5A8B0>
    │   └ <function raise_mysql_exception at 0x00000270868935E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$upm11Z3e1M1kmGdbJJfC6eHhrCgk.cx1VEGi1nmRL85BiSC45plve', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-09 21:33:56.034 | ERROR    | core.exception:all_exception_handler:140 - (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$TNmglXlq.5fBOog4Pakt7eRhTGK0T7IE5y1K/AbxZbpXHOTPTM8ru', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001EA45C1A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000001EA46355F10>
    └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$TNmglXlq.5fBOog4Pakt7eRhTGK0T7IE5y1K/AbxZbpXHOTPTM8ru', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x000001EA463A3D30>
    └ <pymysql.cursors.Cursor object at 0x000001EA4681ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x000001EA463AB1F0>
             └ <pymysql.cursors.Cursor object at 0x000001EA4681ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x000001EA463B5280>
    └ <pymysql.connections.Connection object at 0x000001EA465ACC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000001EA463B5940>
    │    │                └ <pymysql.connections.Connection object at 0x000001EA465ACC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000001EA465ACC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000001EA463B9160>
    └ <pymysql.connections.MySQLResult object at 0x000001EA4677F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000001EA4677F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000001EA463B4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x000001EA4681A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000001EA4681A8B0>
    │   └ <function raise_mysql_exception at 0x000001EA463545E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

pymysql.err.OperationalError: (1364, "Field 'last_ip' doesn't have a default value")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001EA46...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA46731100>
          └ <fastapi.applications.FastAPI object at 0x000001EA465FE8E0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001EA4672DA60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EA467310A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EA46731100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001EA4672DA60>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x000001EA465BE670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EA467310A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001EA467310A0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731190>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EA467310A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001EA467895E0>
    └ <anyio._backends._asyncio.Event object at 0x000001EA46731CD0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001EA46897DC0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001EA467580B0>
    └ <contextlib._GeneratorContextManager object at 0x000001EA46731D00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001EA4671CB80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001EA46731CA0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001EA4671C670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731190>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001EA46731CA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001EA4671CB80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001EA4672D670>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA4671CF70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731310>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001EA467895E0>
    └ <anyio._backends._asyncio.Event object at 0x000001EA46782340>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001EA46897C00>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001EA46771890>
    └ <contextlib._GeneratorContextManager object at 0x000001EA46782310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001EA46793AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001EA46782370>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001EA4671C5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731310>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001EA46782370>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001EA46793AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001EA46793CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA467312E0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001EA46731310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001EA46793CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001EA4677FEE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001EA4670ABB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EA467312E0>
          └ <function wrap_app_handling_exceptions at 0x000001EA4437AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA46793F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001EA4670ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA46793F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EA4670ABB0>>
          └ <fastapi.routing.APIRouter object at 0x000001EA4670ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA46793F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001EA443A80D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA46793F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001EA4672D790>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA46793F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001EA4677F580>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001EA4679D040>
          └ <function wrap_app_handling_exceptions at 0x000001EA4437AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EA4679D0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001EA46793B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001EA4679D040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001EA4677F580>
                     └ <function get_request_handler.<locals>.app at 0x000001EA4672D700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001EA443ADCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x000001EA4677F790>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x000001EA465BEAF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x000001EA4677F790>
          │    └ <function create at 0x000001EA465AA820>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 21, in create
    db.commit()
    │  └ <function Session.commit at 0x000001EA45EDA9D0>
    └ <sqlalchemy.orm.session.Session object at 0x000001EA4677F790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000001EA45ED5C10>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA4680AA00>

  File "<string>", line 2, in commit

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA4680AA00>
                └ <function SessionTransaction.commit at 0x000001EA45ED5B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000001EA45ED5AF0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA4680AA00>

  File "<string>", line 2, in _prepare_impl

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA4680AA00>
                └ <function SessionTransaction._prepare_impl at 0x000001EA45ED59D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000001EA45EE1790>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001EA4677F790>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA4680AA00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001EA45EE1940>
    └ <sqlalchemy.orm.session.Session object at 0x000001EA4677F790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x000001EA45ED5E50>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001EA46816680>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001EA46897400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001EA45ECCA60>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001EA4681FE80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001EA4681FE80>
    │   └ <function SaveUpdateAll.execute at 0x000001EA45ECD3A0>
    └ SaveUpdateAll(Mapper[User(users)])

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001EA45EA15E0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py'>
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\preloaded.py'>
    └ <module 'sqlalchemy.util' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x000001EA45EAF160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x000001EA45B5B160>
             └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x000001EA4681FA60>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001EA45B5B430>
           └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001EA45B5B5E0>
          └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001EA45B5B670>
           └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001EA45B5B8B0>
    └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(1364, "Field 'last_ip' doesn't have a default value")
          │                    │              └ (<class 'pymysql.err.OperationalError'>, OperationalError(1364, "Field 'last_ip' doesn't have a default value"), <traceback o...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001EA45C1A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x000001EA46355F10>
    └ <sqlalchemy.engine.base.Connection object at 0x000001EA4681A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$TNmglXlq.5fBOog4Pakt7eRhTGK0T7IE5y1K/AbxZbpXHOTPTM8ru', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x000001EA463A3D30>
    └ <pymysql.cursors.Cursor object at 0x000001EA4681ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x000001EA463AB1F0>
             └ <pymysql.cursors.Cursor object at 0x000001EA4681ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x000001EA463B5280>
    └ <pymysql.connections.Connection object at 0x000001EA465ACC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x000001EA463B5940>
    │    │                └ <pymysql.connections.Connection object at 0x000001EA465ACC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x000001EA465ACC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x000001EA463B9160>
    └ <pymysql.connections.MySQLResult object at 0x000001EA4677F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x000001EA4677F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x000001EA463B4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x000001EA4681A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x000001EA4681A8B0>
    │   └ <function raise_mysql_exception at 0x000001EA463545E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$TNmglXlq.5fBOog4Pakt7eRhTGK0T7IE5y1K/AbxZbpXHOTPTM8ru', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-09 21:34:24.510 | ERROR    | core.exception:all_exception_handler:140 - (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$wGcL85lT4mDL00g.kEA.u.FSXLXnOhQlq3a3wmhYSVFPjx3N/ryte', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000018DA2B2A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000018DA3265F10>
    └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$wGcL85lT4mDL00g.kEA.u.FSXLXnOhQlq3a3wmhYSVFPjx3N/ryte', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x0000018DA32B2D30>
    └ <pymysql.cursors.Cursor object at 0x0000018DA372ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x0000018DA32BB1F0>
             └ <pymysql.cursors.Cursor object at 0x0000018DA372ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x0000018DA32C5280>
    └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000018DA32C5940>
    │    │                └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000018DA32C9160>
    └ <pymysql.connections.MySQLResult object at 0x0000018DA368F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000018DA368F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000018DA32C4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x0000018DA372A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000018DA372A8B0>
    │   └ <function raise_mysql_exception at 0x0000018DA32645E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

pymysql.err.OperationalError: (1364, "Field 'last_ip' doesn't have a default value")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018DA3...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018DA3641100>
          └ <fastapi.applications.FastAPI object at 0x0000018DA350E8E0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018DA363DA60>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018DA36410A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018DA3641100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '118', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018DA363DA60>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000018DA34CD670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018DA36410A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000018DA36410A0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641190>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018DA36410A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000018DA36995E0>
    └ <anyio._backends._asyncio.Event object at 0x0000018DA3641CD0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000018DA37A6DC0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000018DA36680B0>
    └ <contextlib._GeneratorContextManager object at 0x0000018DA3641D00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000018DA362CB80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000018DA3641CA0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000018DA362C670>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641190>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000018DA3641CA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000018DA362CB80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000018DA363D670>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA362CF70>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641310>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000018DA36995E0>
    └ <anyio._backends._asyncio.Event object at 0x0000018DA3692340>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000018DA3148340>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\'...
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000018DA3681890>
    └ <contextlib._GeneratorContextManager object at 0x0000018DA3692310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000018DA36A3AF0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000018DA3692370>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000018DA362C5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641310>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000018DA3692370>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000018DA36A3AF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000018DA36A3CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018DA36412E0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000018DA3641310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000018DA36A3CA0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000018DA368FEE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000018DA361ABB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018DA36412E0>
          └ <function wrap_app_handling_exceptions at 0x0000018DA225AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36A3F70>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000018DA361ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36A3F70>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018DA361ABB0>>
          └ <fastapi.routing.APIRouter object at 0x0000018DA361ABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36A3F70>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x0000018DA22870D0>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36A3F70>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000018DA363D790>
          └ APIRoute(path='/user/register', name='注册用户', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36A3F70>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000018DA368F580>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018DA36AB040>
          └ <function wrap_app_handling_exceptions at 0x0000018DA225AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018DA36AB0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000018DA36A3B80>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000018DA36AB040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000018DA368F580>
                     └ <function get_request_handler.<locals>.app at 0x0000018DA363D700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000018DA228CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'db': <sqlalchemy.orm.session.Session object at 0x0000018DA368F790>, 'req': RegisterUser(mobile='18611570121', password='123...
                 │         └ <function register_user at 0x0000018DA34CDAF0>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(Pydant...

  File "E:\workspace\zadmin\apps\user\views.py", line 33, in register_user
    await user.create(db, req)
          │    │      │   └ RegisterUser(mobile='18611570121', password='123456', name='laozhu', nickname='laozhu', disabled=False)
          │    │      └ <sqlalchemy.orm.session.Session object at 0x0000018DA368F790>
          │    └ <function create at 0x0000018DA34BA820>
          └ <module 'apps.user.services.user' from 'E:\\workspace\\zadmin\\apps\\user\\services\\user.py'>

  File "E:\workspace\zadmin\apps\user\services\user.py", line 21, in create
    db.commit()
    │  └ <function Session.commit at 0x0000018DA2DEB9D0>
    └ <sqlalchemy.orm.session.Session object at 0x0000018DA368F790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000018DA2DE5C10>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3719B40>

  File "<string>", line 2, in commit

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3719B40>
                └ <function SessionTransaction.commit at 0x0000018DA2DE5B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000018DA2DE5AF0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3719B40>

  File "<string>", line 2, in _prepare_impl

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3719B40>
                └ <function SessionTransaction._prepare_impl at 0x0000018DA2DE59D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000018DA2DF1790>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000018DA368F790>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3719B40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000018DA2DF1940>
    └ <sqlalchemy.orm.session.Session object at 0x0000018DA368F790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4488, in _flush
    transaction.rollback(_capture_exception=True)
    │           └ <function SessionTransaction.rollback at 0x0000018DA2DE5E50>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000018DA3444200>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000018DA37A6480>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000018DA2DDBA60>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000018DA3734E80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000018DA3734E80>
    │   └ <function SaveUpdateAll.execute at 0x0000018DA2DDD3A0>
    └ SaveUpdateAll(Mapper[User(users)])

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000018DA2DB15E0>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\orm\\persistence.py'>
    │    └ <module 'sqlalchemy.util.preloaded' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\preloaded.py'>
    └ <module 'sqlalchemy.util' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\sqlalchemy\\util\\__init__.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    └ <function _emit_insert_statements at 0x0000018DA2DBF160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\orm\persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
             │          └ <function Connection.execute at 0x0000018DA2A6B160>
             └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Insert object at 0x0000018DA3734A60>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000018DA2A6B430>
           └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000018DA2A6B5E0>
          └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000018DA2A6B670>
           └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000018DA2A6B8B0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError(1364, "Field 'last_ip' doesn't have a default value")
          │                    │              └ (<class 'pymysql.err.OperationalError'>, OperationalError(1364, "Field 'last_ip' doesn't have a default value"), <traceback o...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(pymysql.err.OperationalError) (1364, "Field \'last_ip\' doesn\'t have a default value")')

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000018DA2B2A1F0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x0000018DA3265F10>
    └ <sqlalchemy.engine.base.Connection object at 0x0000018DA372A040>

  File "E:\workspace\zadmin\.venv\lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'mobile': '18611570121', 'password': '$2b$12$wGcL85lT4mDL00g.kEA.u.FSXLXnOhQlq3a3wmhYSVFPjx3N/ryte', 'name': 'laozhu', 'nick...
    │      │       └ 'INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mo...
    │      └ <function Cursor.execute at 0x0000018DA32B2D30>
    └ <pymysql.cursors.Cursor object at 0x0000018DA372ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 153, in execute
    result = self._query(query)
             │    │      └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
             │    └ <function Cursor._query at 0x0000018DA32BB1F0>
             └ <pymysql.cursors.Cursor object at 0x0000018DA372ACD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\cursors.py", line 322, in _query
    conn.query(q)
    │    │     └ "INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES ('186...
    │    └ <function Connection.query at 0x0000018DA32C5280>
    └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x0000018DA32C5940>
    │    │                └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x0000018DA34BCC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 825, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x0000018DA32C9160>
    └ <pymysql.connections.MySQLResult object at 0x0000018DA368F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x0000018DA368F910>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\connections.py", line 775, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x0000018DA32C4E50>
    └ <pymysql.protocol.MysqlPacket object at 0x0000018DA372A8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x0000018DA372A8B0>
    │   └ <function raise_mysql_exception at 0x0000018DA32645E0>
    └ <module 'pymysql.err' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\pymysql\\err.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\pymysql\err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Field 'last_ip' doesn't have a default value"
          │          └ 1364
          └ <class 'pymysql.err.OperationalError'>

sqlalchemy.exc.OperationalError: (pymysql.err.OperationalError) (1364, "Field 'last_ip' doesn't have a default value")
[SQL: INSERT INTO users (mobile, password, name, nickname, gender, disabled, is_reset_password, is_staff, deleted_at) VALUES (%(mobile)s, %(password)s, %(name)s, %(nickname)s, %(gender)s, %(disabled)s, %(is_reset_password)s, %(is_staff)s, %(deleted_at)s)]
[parameters: {'mobile': '18611570121', 'password': '$2b$12$wGcL85lT4mDL00g.kEA.u.FSXLXnOhQlq3a3wmhYSVFPjx3N/ryte', 'name': 'laozhu', 'nickname': 'laozhu', 'gender': None, 'disabled': 0, 'is_reset_password': 0, 'is_staff': 0, 'deleted_at': None}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2024-12-09 21:35:09.865 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/register http/1.1' 200utf-8 b'60' 0.5578303337097168
2024-12-09 21:36:37.593 | ERROR    | core.exception:all_exception_handler:140 - 'User' object has no attribute 'is_active'
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x000001A683A59670>
  |     └ <anyio._backends._asyncio.Event object at 0x000001A683A01CD0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6839FCB80>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001A683A01100>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6839FCB80>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x000001A68388D670>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000001A683A59670>
    |     └ <anyio._backends._asyncio.Event object at 0x000001A683A01CD0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000001A683B00900>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'User' object has no attribute 'is_active'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000001A683A290B0>
    |     └ <contextlib._GeneratorContextManager object at 0x000001A683A01D00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6839FCCA0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A683A01CA0>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001A6839EC700>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000001A683A01CA0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6839FCCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'User' object has no attribute 'is_active'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A6839ECD30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6839FC0D0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000001A683A59670>
    |     └ <anyio._backends._asyncio.Event object at 0x000001A683A51340>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000001A683B007C0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'User' object has no attribute 'is_active'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000001A683A41890>
    |     └ <contextlib._GeneratorContextManager object at 0x000001A683A51310>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A683A62B80>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A683A51370>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001A6839EC5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000001A683A51370>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A683A62B80>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'User' object has no attribute 'is_active'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A683A62D30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A683A012E0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A683A62D30>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x000001A683A4FEE0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A683A012E0>
    |           └ <function wrap_app_handling_exceptions at 0x000001A68164AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001A6839DABB0>>
    |           └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x000001A6816780D0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x000001A6839FC3A0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x000001A683A4F580>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001A683A6A0D0>
    |           └ <function wrap_app_handling_exceptions at 0x000001A68164AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A160>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x000001A683A6A0D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x000001A683A4F580>
    |                      └ <function get_request_handler.<locals>.app at 0x000001A6839FC4C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x000001A68167CCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x000001A6839F1550>, 'db': <sqlalchemy.orm.session.Sess...
    |                  │         └ <function api_login_for_access_token at 0x000001A683872940>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 24, in api_login_for_access_token
    |     resp = auth.check_user_login(db, data)
    |            │    │                │   └ <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x000001A6839F1550>
    |            │    │                └ <sqlalchemy.orm.session.Session object at 0x000001A683A74460>
    |            │    └ <function check_user_login at 0x000001A683270D30>
    |            └ <module 'apps.user.services.auth' from 'E:\\workspace\\zadmin\\apps\\user\\services\\auth.py'>
    |
    |   File "E:\workspace\zadmin\apps\user\services\auth.py", line 28, in check_user_login
    |     if not user.is_active:
    |            └ <apps.user.models.User object at 0x000001A683AECAC0>
    |
    | AttributeError: 'User' object has no attribute 'is_active'
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A683...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001A683A01100>
          └ <fastapi.applications.FastAPI object at 0x000001A6838CE8E0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6839FCB80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001A683A01100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001A6839FCB80>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x000001A68388D670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001A...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001A683A010A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001A683A59670>
    └ <anyio._backends._asyncio.Event object at 0x000001A683A01CD0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001A683B00900>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'User' object has no attribute 'is_active'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001A683A290B0>
    └ <contextlib._GeneratorContextManager object at 0x000001A683A01D00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6839FCCA0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A683A01CA0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001A6839EC700>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001A683A01CA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A6839FCCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'User' object has no attribute 'is_active'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A6839ECD30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A6839FC0D0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001A683A59670>
    └ <anyio._backends._asyncio.Event object at 0x000001A683A51340>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001A683B007C0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'User' object has no attribute 'is_active'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001A683A41890>
    └ <contextlib._GeneratorContextManager object at 0x000001A683A51310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A683A62B80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001A683A51370>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001A6839EC5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001A683A51370>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001A683A62B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'User' object has no attribute 'is_active'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A683A62D30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A683A012E0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001A683A01310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001A683A62D30>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001A683A4FEE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001A683A012E0>
          └ <function wrap_app_handling_exceptions at 0x000001A68164AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001A6839DABB0>>
          └ <fastapi.routing.APIRouter object at 0x000001A6839DABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001A6816780D0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001A6839FC3A0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A040>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001A683A4F580>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001A683A6A0D0>
          └ <function wrap_app_handling_exceptions at 0x000001A68164AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001A683A6A160>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001A683A62C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001A683A6A0D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001A683A4F580>
                     └ <function get_request_handler.<locals>.app at 0x000001A6839FC4C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x000001A68167CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x000001A6839F1550>, 'db': <sqlalchemy.orm.session.Sess...
                 │         └ <function api_login_for_access_token at 0x000001A683872940>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "E:\workspace\zadmin\apps\user\views.py", line 24, in api_login_for_access_token
    resp = auth.check_user_login(db, data)
           │    │                │   └ <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x000001A6839F1550>
           │    │                └ <sqlalchemy.orm.session.Session object at 0x000001A683A74460>
           │    └ <function check_user_login at 0x000001A683270D30>
           └ <module 'apps.user.services.auth' from 'E:\\workspace\\zadmin\\apps\\user\\services\\auth.py'>

  File "E:\workspace\zadmin\apps\user\services\auth.py", line 28, in check_user_login
    if not user.is_active:
           └ <apps.user.models.User object at 0x000001A683AECAC0>

AttributeError: 'User' object has no attribute 'is_active'
2024-12-09 21:37:12.690 | ERROR    | core.exception:all_exception_handler:140 - Object of type SuccessResponse is not JSON serializable
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x0000019D18C69670>
  |     └ <anyio._backends._asyncio.Event object at 0x0000019D18C11CD0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019D18C0BB80>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019D18C11100>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019D18C0BB80>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x0000019D18A9E670>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000019D18C69670>
    |     └ <anyio._backends._asyncio.Event object at 0x0000019D18C11CD0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000019D18D10880>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000019D18C380B0>
    |     └ <contextlib._GeneratorContextManager object at 0x0000019D18C11D00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C0BCA0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C11CA0>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000019D18BFB700>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C11CA0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C0BCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type SuccessResponse is not JSON serializable')
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18BFBD30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C0B0D0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000019D18C69670>
    |     └ <anyio._backends._asyncio.Event object at 0x0000019D18C61340>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000019D18D10680>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000019D18C52890>
    |     └ <contextlib._GeneratorContextManager object at 0x0000019D18C61310>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C72B80>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C61370>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000019D18BFB5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C61370>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C72B80>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type SuccessResponse is not JSON serializable')
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18C72D30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019D18C112E0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18C72D30>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x0000019D18C5FEE0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019D18C112E0>
    |           └ <function wrap_app_handling_exceptions at 0x0000019D1782AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>>
    |           └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x0000019D178580D0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x0000019D18C0B3A0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x0000019D18C5F580>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000019D18C7A0D0>
    |           └ <function wrap_app_handling_exceptions at 0x0000019D1782AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A160>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x0000019D18C7A0D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x0000019D18C5F580>
    |                      └ <function get_request_handler.<locals>.app at 0x0000019D18C0B4C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x0000019D1785CCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x0000019D18C5FDF0>, 'db': <sqlalchemy.orm.session.Sess...
    |                  │         └ <function api_login_for_access_token at 0x0000019D18A82940>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 25, in api_login_for_access_token
    |     return SuccessResponse(resp)
    |            │               └ <utils.response.SuccessResponse object at 0x0000019D18CD4B80>
    |            └ <class 'utils.response.SuccessResponse'>
    |
    |   File "E:\workspace\zadmin\utils\response.py", line 18, in __init__
    |     super().__init__(content=self.data, status_code=status)
    |                              │    │                 └ 200
    |                              │    └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    |                              └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 180, in __init__
    |     super().__init__(content, status_code, headers, media_type, background)
    |                      │        │            │        │           └ None
    |                      │        │            │        └ None
    |                      │        │            └ None
    |                      │        └ 200
    |                      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 43, in __init__
    |     self.body = self.render(content)
    |     │           │    │      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    |     │           │    └ <function JSONResponse.render at 0x0000019D17788280>
    |     │           └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>
    |     └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 183, in render
    |     return json.dumps(
    |            │    └ <function dumps at 0x0000019D150A0550>
    |            └ <module 'json' from 'D:\\tool\\python\\lib\\json\\__init__.py'>
    |
    |   File "D:\tool\python\lib\json\__init__.py", line 234, in dumps
    |     return cls(
    |            └ <class 'json.encoder.JSONEncoder'>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 199, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    |              │    └ <function JSONEncoder.iterencode at 0x0000019D150A04C0>
    |              └ <json.encoder.JSONEncoder object at 0x0000019D18CFCC70>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 257, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    |            └ <_json.Encoder object at 0x0000019D18D18520>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 179, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type SuccessResponse is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019D18...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019D18C11100>
          └ <fastapi.applications.FastAPI object at 0x0000019D18ADF8E0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019D18C0BB80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000019D18C11100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000019D18C0BB80>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000019D18A9E670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000019...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000019D18C110A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000019D18C69670>
    └ <anyio._backends._asyncio.Event object at 0x0000019D18C11CD0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000019D18D10880>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000019D18C380B0>
    └ <contextlib._GeneratorContextManager object at 0x0000019D18C11D00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C0BCA0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C11CA0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000019D18BFB700>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C11CA0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C0BCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError('Object of type SuccessResponse is not JSON serializable')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18BFBD30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C0B0D0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000019D18C69670>
    └ <anyio._backends._asyncio.Event object at 0x0000019D18C61340>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000019D18D10680>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000019D18C52890>
    └ <contextlib._GeneratorContextManager object at 0x0000019D18C61310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C72B80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C61370>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000019D18BFB5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000019D18C61370>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000019D18C72B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError('Object of type SuccessResponse is not JSON serializable')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18C72D30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019D18C112E0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000019D18C11310>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000019D18C72D30>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000019D18C5FEE0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000019D18C112E0>
          └ <function wrap_app_handling_exceptions at 0x0000019D1782AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>>
          └ <fastapi.routing.APIRouter object at 0x0000019D18BEABB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x0000019D178580D0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000019D18C0B3A0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A040>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000019D18C5F580>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000019D18C7A0D0>
          └ <function wrap_app_handling_exceptions at 0x0000019D1782AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000019D18C7A160>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000019D18C72C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000019D18C7A0D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000019D18C5F580>
                     └ <function get_request_handler.<locals>.app at 0x0000019D18C0B4C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000019D1785CCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x0000019D18C5FDF0>, 'db': <sqlalchemy.orm.session.Sess...
                 │         └ <function api_login_for_access_token at 0x0000019D18A82940>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "E:\workspace\zadmin\apps\user\views.py", line 25, in api_login_for_access_token
    return SuccessResponse(resp)
           │               └ <utils.response.SuccessResponse object at 0x0000019D18CD4B80>
           └ <class 'utils.response.SuccessResponse'>

  File "E:\workspace\zadmin\utils\response.py", line 18, in __init__
    super().__init__(content=self.data, status_code=status)
                             │    │                 └ 200
                             │    └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
                             └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 180, in __init__
    super().__init__(content, status_code, headers, media_type, background)
                     │        │            │        │           └ None
                     │        │            │        └ None
                     │        │            └ None
                     │        └ 200
                     └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 43, in __init__
    self.body = self.render(content)
    │           │    │      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
    │           │    └ <function JSONResponse.render at 0x0000019D17788280>
    │           └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>
    └ <utils.response.SuccessResponse object at 0x0000019D18CFCAC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 183, in render
    return json.dumps(
           │    └ <function dumps at 0x0000019D150A0550>
           └ <module 'json' from 'D:\\tool\\python\\lib\\json\\__init__.py'>

  File "D:\tool\python\lib\json\__init__.py", line 234, in dumps
    return cls(
           └ <class 'json.encoder.JSONEncoder'>

  File "D:\tool\python\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
             │    └ <function JSONEncoder.iterencode at 0x0000019D150A04C0>
             └ <json.encoder.JSONEncoder object at 0x0000019D18CFCC70>

  File "D:\tool\python\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
           │           └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000019D18CD4B80>}
           └ <_json.Encoder object at 0x0000019D18D18520>

  File "D:\tool\python\lib\json\encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type SuccessResponse is not JSON serializable
2024-12-09 21:38:33.534 | ERROR    | core.exception:all_exception_handler:140 - Object of type SuccessResponse is not JSON serializable
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x0000014EEAD07670>
  |     └ <anyio._backends._asyncio.Event object at 0x0000014EEACB1CA0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000014EEACACB80>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000014EEACB1070>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    |     await self.simple_response(scope, receive, send, request_headers=headers)
    |           │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
    |           │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000014EEACACB80>
    |           │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
    |           │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function CORSMiddleware.simple_response at 0x0000014EEAB3E670>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190...
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000014EEAD07670>
    |     └ <anyio._backends._asyncio.Event object at 0x0000014EEACB1CA0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000014EEADB2840>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000014EEACD80B0>
    |     └ <contextlib._GeneratorContextManager object at 0x0000014EEACB1CD0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEACACCA0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACB1C70>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000014EEAC9B700>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACB1C70>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEACACCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type SuccessResponse is not JSON serializable')
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAC9BD30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEACAC0D0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000014EEAD07670>
    |     └ <anyio._backends._asyncio.Event object at 0x0000014EEACF4B80>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000014EEADB2540>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000014EEACF1890>
    |     └ <contextlib._GeneratorContextManager object at 0x0000014EEACF4BB0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEAD11B80>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACF4B50>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000014EEAC9B5E0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACF4B50>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEAD11B80>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ TypeError('Object of type SuccessResponse is not JSON serializable')
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAD11D30>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000014EEACA1550>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAD11D30>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x0000014EEAD152E0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000014EEACA1550>
    |           └ <function wrap_app_handling_exceptions at 0x0000014EE88FAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>>
    |           └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x0000014EE89280D0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x0000014EEACAC3A0>
    |           └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x0000014EEAD157F0>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000014EEAD1A0D0>
    |           └ <function wrap_app_handling_exceptions at 0x0000014EE88FAA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A160>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x0000014EEAD1A0D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x0000014EEAD157F0>
    |                      └ <function get_request_handler.<locals>.app at 0x0000014EEACAC4C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    |     raw_response = await run_endpoint_function(
    |                          └ <function run_endpoint_function at 0x0000014EE892DCA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    |     return await dependant.call(**values)
    |                  │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x0000014EEAD15B80>, 'db': <sqlalchemy.orm.session.Sess...
    |                  │         └ <function api_login_for_access_token at 0x0000014EEAB29940>
    |                  └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...
    |
    |   File "E:\workspace\zadmin\apps\user\views.py", line 25, in api_login_for_access_token
    |
    |   File "E:\workspace\zadmin\utils\response.py", line 18, in __init__
    |     super().__init__(content=self.data, status_code=status)
    |                              │    │                 └ 200
    |                              │    └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    |                              └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 180, in __init__
    |     super().__init__(content, status_code, headers, media_type, background)
    |                      │        │            │        │           └ None
    |                      │        │            │        └ None
    |                      │        │            └ None
    |                      │        └ 200
    |                      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 43, in __init__
    |     self.body = self.render(content)
    |     │           │    │      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    |     │           │    └ <function JSONResponse.render at 0x0000014EE8858280>
    |     │           └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>
    |     └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 183, in render
    |     return json.dumps(
    |            │    └ <function dumps at 0x0000014EE7140550>
    |            └ <module 'json' from 'D:\\tool\\python\\lib\\json\\__init__.py'>
    |
    |   File "D:\tool\python\lib\json\__init__.py", line 234, in dumps
    |     return cls(
    |            └ <class 'json.encoder.JSONEncoder'>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 199, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |              │    │          └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    |              │    └ <function JSONEncoder.iterencode at 0x0000014EE71404C0>
    |              └ <json.encoder.JSONEncoder object at 0x0000014EEAD98C40>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 257, in iterencode
    |     return _iterencode(o, 0)
    |            │           └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    |            └ <_json.Encoder object at 0x0000014EEADB94C0>
    |
    |   File "D:\tool\python\lib\json\encoder.py", line 179, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |
    | TypeError: Object of type SuccessResponse is not JSON serializable
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014EEA...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000014EEACB1070>
          └ <fastapi.applications.FastAPI object at 0x0000014EEAB7FFA0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000014EEACACB80>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000014EEACB1070>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': '127.0.0.1:8081', 'connection': 'keep-alive', 'content-length': '101', 'sec-ch-ua-platform': '"Windows"', 'u...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000014EEACACB80>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000014EEAB3E670>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000014...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000014EEACB1190>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000014EEAD07670>
    └ <anyio._backends._asyncio.Event object at 0x0000014EEACB1CA0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000014EEADB2840>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000014EEACD80B0>
    └ <contextlib._GeneratorContextManager object at 0x0000014EEACB1CD0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEACACCA0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACB1C70>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000014EEAC9B700>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACB1C70>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEACACCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError('Object of type SuccessResponse is not JSON serializable')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAC9BD30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEACAC0D0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB11F0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000014EEAD07670>
    └ <anyio._backends._asyncio.Event object at 0x0000014EEACF4B80>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000014EEADB2540>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [TypeError('Object of type SuccessResponse is not JSON serializable')])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000014EEACF1890>
    └ <contextlib._GeneratorContextManager object at 0x0000014EEACF4BB0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEAD11B80>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACF4B50>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000014EEAC9B5E0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000014EEACF4B50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000014EEAD11B80>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ TypeError('Object of type SuccessResponse is not JSON serializable')

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAD11D30>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000014EEACA1550>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000014EEACB12B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000014EEAD11D30>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000014EEAD152E0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000014EEACA1550>
          └ <function wrap_app_handling_exceptions at 0x0000014EE88FAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>>
          └ <fastapi.routing.APIRouter object at 0x0000014EEAC8AD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x0000014EE89280D0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000014EEACAC3A0>
          └ APIRoute(path='/user/api/login', name='api_login_for_access_token', methods=['POST'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A040>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000014EEAD157F0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000014EEAD1A0D0>
          └ <function wrap_app_handling_exceptions at 0x0000014EE88FAA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000014EEAD1A160>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000014EEAD11C10>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000014EEAD1A0D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000014EEAD157F0>
                     └ <function get_request_handler.<locals>.app at 0x0000014EEACAC4C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000014EE892DCA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'data': <fastapi.security.oauth2.OAuth2PasswordRequestForm object at 0x0000014EEAD15B80>, 'db': <sqlalchemy.orm.session.Sess...
                 │         └ <function api_login_for_access_token at 0x0000014EEAB29940>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "E:\workspace\zadmin\apps\user\views.py", line 25, in api_login_for_access_token

  File "E:\workspace\zadmin\utils\response.py", line 18, in __init__
    super().__init__(content=self.data, status_code=status)
                             │    │                 └ 200
                             │    └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
                             └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 180, in __init__
    super().__init__(content, status_code, headers, media_type, background)
                     │        │            │        │           └ None
                     │        │            │        └ None
                     │        │            └ None
                     │        └ 200
                     └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 43, in __init__
    self.body = self.render(content)
    │           │    │      └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
    │           │    └ <function JSONResponse.render at 0x0000014EE8858280>
    │           └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>
    └ <utils.response.SuccessResponse object at 0x0000014EEAD98A90>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\responses.py", line 183, in render
    return json.dumps(
           │    └ <function dumps at 0x0000014EE7140550>
           └ <module 'json' from 'D:\\tool\\python\\lib\\json\\__init__.py'>

  File "D:\tool\python\lib\json\__init__.py", line 234, in dumps
    return cls(
           └ <class 'json.encoder.JSONEncoder'>

  File "D:\tool\python\lib\json\encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
             │    │          └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
             │    └ <function JSONEncoder.iterencode at 0x0000014EE71404C0>
             └ <json.encoder.JSONEncoder object at 0x0000014EEAD98C40>

  File "D:\tool\python\lib\json\encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
           │           └ {'code': 200, 'message': 'success', 'data': <utils.response.SuccessResponse object at 0x0000014EEAD75B50>}
           └ <_json.Encoder object at 0x0000014EEADB94C0>

  File "D:\tool\python\lib\json\encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '

TypeError: Object of type SuccessResponse is not JSON serializable
2024-12-09 21:45:40.568 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/api/login http/1.1' 200utf-8 b'228' 0.49652886390686035
2024-12-09 21:58:13.289 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.003542184829711914
2024-12-09 21:58:14.549 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'3841' 0.08653664588928223
2024-12-09 21:58:29.163 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/api/login http/1.1' 200utf-8 b'226' 0.43060851097106934
2024-12-09 22:04:23.934 | ERROR    | core.exception:unicorn_exception_handler:66 - 401: Could not validate credentials
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 176, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
                                    │   └ <method 'rsplit' of 'bytes' objects>
                                    └ b'undefined'

ValueError: not enough values to unpack (expected 2, got 1)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 142, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
              │   │      │      │    │                  └ True
              │   │      │      │    └ ['HS256']
              │   │      │      └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      └ 'undefined'
              │   └ <function verify at 0x000001ED9803C820>
              └ <module 'jose.jws' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jws.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 70, in verify
    header, payload, signing_input, signature = _load(token)
                                                │     └ 'undefined'
                                                └ <function _load at 0x000001ED980585E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 180, in _load
    raise JWSError("Not enough segments")
          └ <class 'jose.exceptions.JWSError'>

jose.exceptions.JWSError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 28, in get_current_user
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
              │   │      │      │        │                       │        └ 'HS256'
              │   │      │      │        │                       └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      │      │        └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      │      └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      └ 'undefined'
              │   └ <function decode at 0x000001ED98058820>
              └ <module 'jose.jwt' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jwt.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 144, in decode
    raise JWTError(e)
          └ <class 'jose.exceptions.JWTError'>

jose.exceptions.JWTError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 280
               │     └ 3
               └ <function _main at 0x000001ED92DE6A60>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 280
           │    └ <function BaseProcess._bootstrap at 0x000001ED92CB88B0>
           └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001ED92CACEE0>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001ED92E049D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    └ <function subprocess_started at 0x000001ED94D60A60>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001ED92E04A00>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
           │       │   │    └ <function Server.serve at 0x000001ED94D5FCA0>
           │       │   └ <uvicorn.server.Server object at 0x000001ED92E04A00>
           │       └ <function run at 0x000001ED92E03940>
           └ <module 'asyncio' from 'D:\\tool\\python\\lib\\asyncio\\__init__.py'>

  File "D:\tool\python\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001ED9846D940>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001ED949B4CA0>
           └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 634, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001ED949B4C10>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 601, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001ED949B7790>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 1905, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001ED949541F0>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9866FC70>(<Future finished result=False>)>

  File "D:\tool\python\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9866FC70>(<Future finished result=False>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9866FC70>(<Future finished result=False>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9866FC70>(<Future finished result=False>)>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED9866C550>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED9866C550>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001ED9864EB20>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C820>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C820>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001ED985DFD00>>
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C820>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001ED972370D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C820>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001ED98609A60>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C820>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001ED9866F1C0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9866C8B0>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9866C940>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C430>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9866C8B0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001ED9866F1C0>
                     └ <function get_request_handler.<locals>.app at 0x000001ED986099D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                          └ <function solve_dependencies at 0x000001ED971F2550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
                   │      │             └ {'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866F7F0>}
                   │      └ SolvedDependency(values={'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866F7F0>}, errors=[...
                   └ <function get_current_user at 0x000001ED98469C10>

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 33, in get_current_user
    raise credentials_exception
          └ HTTPException(status_code=401, detail='Could not validate credentials')

fastapi.exceptions.HTTPException: 401: Could not validate credentials
2024-12-09 22:04:24.221 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 401utf-8 b'55' 0.2893199920654297
2024-12-09 22:04:30.795 | ERROR    | core.exception:unicorn_exception_handler:66 - 401: Could not validate credentials
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 176, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
                                    │   └ <method 'rsplit' of 'bytes' objects>
                                    └ b'undefined'

ValueError: not enough values to unpack (expected 2, got 1)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 142, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
              │   │      │      │    │                  └ True
              │   │      │      │    └ ['HS256']
              │   │      │      └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      └ 'undefined'
              │   └ <function verify at 0x000001ED9803C820>
              └ <module 'jose.jws' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jws.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 70, in verify
    header, payload, signing_input, signature = _load(token)
                                                │     └ 'undefined'
                                                └ <function _load at 0x000001ED980585E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 180, in _load
    raise JWSError("Not enough segments")
          └ <class 'jose.exceptions.JWSError'>

jose.exceptions.JWSError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 28, in get_current_user
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
              │   │      │      │        │                       │        └ 'HS256'
              │   │      │      │        │                       └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      │      │        └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      │      └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      └ 'undefined'
              │   └ <function decode at 0x000001ED98058820>
              └ <module 'jose.jwt' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jwt.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 144, in decode
    raise JWTError(e)
          └ <class 'jose.exceptions.JWTError'>

jose.exceptions.JWTError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 280
               │     └ 3
               └ <function _main at 0x000001ED92DE6A60>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 280
           │    └ <function BaseProcess._bootstrap at 0x000001ED92CB88B0>
           └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001ED92CACEE0>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001ED92E049D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    └ <function subprocess_started at 0x000001ED94D60A60>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001ED92E04A00>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
           │       │   │    └ <function Server.serve at 0x000001ED94D5FCA0>
           │       │   └ <uvicorn.server.Server object at 0x000001ED92E04A00>
           │       └ <function run at 0x000001ED92E03940>
           └ <module 'asyncio' from 'D:\\tool\\python\\lib\\asyncio\\__init__.py'>

  File "D:\tool\python\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001ED9846D940>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001ED949B4CA0>
           └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 634, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001ED949B4C10>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 601, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001ED949B7790>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 1905, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001ED949541F0>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9879DD30>(<Future finished result=False>)>

  File "D:\tool\python\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9879DD30>(<Future finished result=False>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9879DD30>(<Future finished result=False>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED9879DD30>(<Future finished result=False>)>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED98786EE0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED98786EE0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001ED9879D220>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E0D0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E0D0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001ED985DFD00>>
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E0D0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001ED972370D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E0D0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001ED98609A60>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E0D0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001ED9879D640>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9879E160>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9879E1F0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C790>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9879E160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001ED9879D640>
                     └ <function get_request_handler.<locals>.app at 0x000001ED986099D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                          └ <function solve_dependencies at 0x000001ED971F2550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
                   │      │             └ {'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED98628640>}
                   │      └ SolvedDependency(values={'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED98628640>}, errors=[...
                   └ <function get_current_user at 0x000001ED98469C10>

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 33, in get_current_user
    raise credentials_exception
          └ HTTPException(status_code=401, detail='Could not validate credentials')

fastapi.exceptions.HTTPException: 401: Could not validate credentials
2024-12-09 22:04:30.818 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 401utf-8 b'55' 0.02598285675048828
2024-12-09 22:04:38.367 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.000982522964477539
2024-12-09 22:04:38.724 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'3841' 0.028984546661376953
2024-12-09 22:04:42.693 | ERROR    | core.exception:all_exception_handler:140 - 'NoneType' object has no attribute 'rsplit'
  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x000001ED9865DE50>
  |     └ <anyio._backends._asyncio.Event object at 0x000001ED9879C6A0>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001ED9866C4C0>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001ED98610E20>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001ED98610E50>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001ED9866C4C0>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x000001ED98610E20>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000001ED9865DE50>
    |     └ <anyio._backends._asyncio.Event object at 0x000001ED9879C6A0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000001ED987A5400>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'NoneType' object has no attribute 'rsplit'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000001ED98790740>
    |     └ <contextlib._GeneratorContextManager object at 0x000001ED9879C4C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED9866C5E0>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879C610>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001ED98582E50>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879C610>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED9866C5E0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'NoneType' object has no attribute 'rsplit'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED98609CA0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C3A0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000001ED9865DE50>
    |     └ <anyio._backends._asyncio.Event object at 0x000001ED9879CD90>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000001ED987AACC0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'NoneType' object has no attribute 'rsplit'")])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000001ED98790BA0>
    |     └ <contextlib._GeneratorContextManager object at 0x000001ED9879CBE0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED987AD160>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879CB50>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001ED98582D30>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879CB50>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED987AD160>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ AttributeError("'NoneType' object has no attribute 'rsplit'")
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED987AD4C0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED987AD4C0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x000001ED9879CF70>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
    |           └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001ED985DFD00>>
    |           └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x000001ED972370D0>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x000001ED98609A60>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x000001ED987A8D90>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001ED987AD700>
    |           └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD8B0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x000001ED987AD700>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x000001ED987A8D90>
    |                      └ <function get_request_handler.<locals>.app at 0x000001ED986099D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 291, in app
    |     solved_result = await solve_dependencies(
    |                           └ <function solve_dependencies at 0x000001ED971F2550>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    |     solved = await call(**solved_result.values)
    |                    │      │             └ {'token': None, 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866FD90>}
    |                    │      └ SolvedDependency(values={'token': None, 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866FD90>}, errors=[], back...
    |                    └ <function get_current_user at 0x000001ED98469C10>
    |
    |   File "E:\workspace\zadmin\apps\user\services\oauth.py", line 28, in get_current_user
    |     payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
    |               │   │      │      │        │                       │        └ 'HS256'
    |               │   │      │      │        │                       └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
    |               │   │      │      │        └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
    |               │   │      │      └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
    |               │   │      └ None
    |               │   └ <function decode at 0x000001ED98058820>
    |               └ <module 'jose.jwt' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jwt.py'>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 142, in decode
    |     payload = jws.verify(token, key, algorithms, verify=verify_signature)
    |               │   │      │      │    │                  └ True
    |               │   │      │      │    └ ['HS256']
    |               │   │      │      └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
    |               │   │      └ None
    |               │   └ <function verify at 0x000001ED9803C820>
    |               └ <module 'jose.jws' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jws.py'>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 70, in verify
    |     header, payload, signing_input, signature = _load(token)
    |                                                 │     └ None
    |                                                 └ <function _load at 0x000001ED980585E0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 176, in _load
    |     signing_input, crypto_segment = jwt.rsplit(b".", 1)
    |                                     └ None
    |
    | AttributeError: 'NoneType' object has no attribute 'rsplit'
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001ED98...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001ED98610E50>
          └ <fastapi.applications.FastAPI object at 0x000001ED984E0250>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001ED9866C4C0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001ED98610E20>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001ED98610E50>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001ED9866C4C0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001ED98610E20>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001ED9865DE50>
    └ <anyio._backends._asyncio.Event object at 0x000001ED9879C6A0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001ED987A5400>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'NoneType' object has no attribute 'rsplit'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001ED98790740>
    └ <contextlib._GeneratorContextManager object at 0x000001ED9879C4C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED9866C5E0>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879C610>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000001ED98582E50>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879C610>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED9866C5E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'NoneType' object has no attribute 'rsplit'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED98609CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9866C3A0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610DC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000001ED9865DE50>
    └ <anyio._backends._asyncio.Event object at 0x000001ED9879CD90>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000001ED987AACC0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [AttributeError("'NoneType' object has no attribute 'rsplit'")])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000001ED98790BA0>
    └ <contextlib._GeneratorContextManager object at 0x000001ED9879CBE0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED987AD160>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879CB50>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000001ED98582D30>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000001ED9879CB50>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000001ED987AD160>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ AttributeError("'NoneType' object has no attribute 'rsplit'")

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED987AD4C0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED987AD4C0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001ED9879CF70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001ED985DFD00>>
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001ED972370D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001ED98609A60>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD820>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001ED987A8D90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001ED987AD700>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED987AD8B0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED987AD430>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001ED987AD700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001ED987A8D90>
                     └ <function get_request_handler.<locals>.app at 0x000001ED986099D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                          └ <function solve_dependencies at 0x000001ED971F2550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
                   │      │             └ {'token': None, 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866FD90>}
                   │      └ SolvedDependency(values={'token': None, 'db': <sqlalchemy.orm.session.Session object at 0x000001ED9866FD90>}, errors=[], back...
                   └ <function get_current_user at 0x000001ED98469C10>

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 28, in get_current_user
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
              │   │      │      │        │                       │        └ 'HS256'
              │   │      │      │        │                       └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      │      │        └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      │      └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      └ None
              │   └ <function decode at 0x000001ED98058820>
              └ <module 'jose.jwt' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jwt.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 142, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
              │   │      │      │    │                  └ True
              │   │      │      │    └ ['HS256']
              │   │      │      └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      └ None
              │   └ <function verify at 0x000001ED9803C820>
              └ <module 'jose.jws' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jws.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 70, in verify
    header, payload, signing_input, signature = _load(token)
                                                │     └ None
                                                └ <function _load at 0x000001ED980585E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 176, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
                                    └ None

AttributeError: 'NoneType' object has no attribute 'rsplit'
2024-12-09 22:04:56.521 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/api/login http/1.1' 200utf-8 b'226' 0.4053373336791992
2024-12-09 22:05:00.148 | ERROR    | core.exception:unicorn_exception_handler:66 - 401: Could not validate credentials
Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 176, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
                                    │   └ <method 'rsplit' of 'bytes' objects>
                                    └ b'undefined'

ValueError: not enough values to unpack (expected 2, got 1)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 142, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
              │   │      │      │    │                  └ True
              │   │      │      │    └ ['HS256']
              │   │      │      └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      └ 'undefined'
              │   └ <function verify at 0x000001ED9803C820>
              └ <module 'jose.jws' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jws.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 70, in verify
    header, payload, signing_input, signature = _load(token)
                                                │     └ 'undefined'
                                                └ <function _load at 0x000001ED980585E0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jws.py", line 180, in _load
    raise JWSError("Not enough segments")
          └ <class 'jose.exceptions.JWSError'>

jose.exceptions.JWSError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 28, in get_current_user
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
              │   │      │      │        │                       │        └ 'HS256'
              │   │      │      │        │                       └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      │      │        └ 'vgb0tnl9d58+6n-6h-ea&u^1#s0ccp!794=kbvqacjq75vzps$'
              │   │      │      └ <module 'config.settings' from 'E:\\workspace\\zadmin\\config\\settings.py'>
              │   │      └ 'undefined'
              │   └ <function decode at 0x000001ED98058820>
              └ <module 'jose.jwt' from 'E:\\workspace\\zadmin\\.venv\\lib\\site-packages\\jose\\jwt.py'>

  File "E:\workspace\zadmin\.venv\lib\site-packages\jose\jwt.py", line 144, in decode
    raise JWTError(e)
          └ <class 'jose.exceptions.JWTError'>

jose.exceptions.JWTError: Not enough segments


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 280
               │     └ 3
               └ <function _main at 0x000001ED92DE6A60>

  File "D:\tool\python\lib\multiprocessing\spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 280
           │    └ <function BaseProcess._bootstrap at 0x000001ED92CB88B0>
           └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 315, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001ED92CACEE0>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "D:\tool\python\lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001ED92E049D0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>
    │    └ <function subprocess_started at 0x000001ED94D60A60>
    └ <SpawnProcess name='SpawnProcess-1' parent=10404 started>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001ED92E04A00>>

  File "E:\workspace\zadmin\.venv\lib\site-packages\uvicorn\server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=388, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('0.0.0.0', 8081)>]
           │       │   │    └ <function Server.serve at 0x000001ED94D5FCA0>
           │       │   └ <uvicorn.server.Server object at 0x000001ED92E04A00>
           │       └ <function run at 0x000001ED92E03940>
           └ <module 'asyncio' from 'D:\\tool\\python\\lib\\asyncio\\__init__.py'>

  File "D:\tool\python\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x000001ED9846D940>
           │    └ <function BaseEventLoop.run_until_complete at 0x000001ED949B4CA0>
           └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 634, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001ED949B4C10>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 601, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001ED949B7790>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>

  File "D:\tool\python\lib\asyncio\base_events.py", line 1905, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001ED949541F0>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED98902370>(<Future finished result=False>)>

  File "D:\tool\python\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <TaskWakeupMethWrapper object at 0x000001ED98902370>(<Future finished result=False>)>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <TaskWakeupMethWrapper object at 0x000001ED98902370>(<Future finished result=False>)>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <TaskWakeupMethWrapper object at 0x000001ED98902370>(<Future finished result=False>)>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED9882C940>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000001ED98610D30>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000001ED9882C940>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000001ED987B38E0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001ED98610D00>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882C5E0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882C5E0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001ED985DFD00>>
          └ <fastapi.routing.APIRouter object at 0x000001ED985DFD00>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882C5E0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000001ED972370D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882C5E0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000001ED98609A60>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882C5E0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000001ED987B3BB0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9882CDC0>
          └ <function wrap_app_handling_exceptions at 0x000001ED9720BA60>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001ED9882CC10>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000001ED9882C670>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000001ED9882CDC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000001ED987B3BB0>
                     └ <function get_request_handler.<locals>.app at 0x000001ED986099D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                          └ <function solve_dependencies at 0x000001ED971F2550>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
                   │      │             └ {'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED987B39A0>}
                   │      └ SolvedDependency(values={'token': 'undefined', 'db': <sqlalchemy.orm.session.Session object at 0x000001ED987B39A0>}, errors=[...
                   └ <function get_current_user at 0x000001ED98469C10>

  File "E:\workspace\zadmin\apps\user\services\oauth.py", line 33, in get_current_user
    raise credentials_exception
          └ HTTPException(status_code=401, detail='Could not validate credentials')

fastapi.exceptions.HTTPException: 401: Could not validate credentials
2024-12-09 22:05:00.176 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 401utf-8 b'55' 0.03115057945251465
2024-12-09 22:17:28.917 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.00099945068359375
2024-12-09 22:17:29.291 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'4038' 0.055468082427978516
2024-12-09 22:17:37.944 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/api/login http/1.1' 200utf-8 b'186' 0.42702460289001465
2024-12-09 22:17:46.172 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 200utf-8 b'21' 0.11806297302246094
2024-12-09 22:19:19.549 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 200utf-8 b'21' 0.08314371109008789
2024-12-09 22:22:42.112 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 200utf-8 b'21' 0.0883646011352539
2024-12-09 22:23:29.261 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10 http/1.1' 200utf-8 b'21' 0.10166788101196289
2024-12-09 22:24:41.990 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=asc http/1.1' 200utf-8 b'323' 0.08217120170593262
2024-12-09 22:24:59.101 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'323' 0.017541170120239258
2024-12-09 22:30:40.904 | ERROR    | core.exception:all_exception_handler:140 - 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}

  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x0000025061DE9310>
  |     └ <anyio._backends._asyncio.Event object at 0x0000025061D9DC10>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000025061D89820>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000025061D7EC70>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000025061D7EC40>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000025061D89820>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x0000025061D7EC70>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000025061DE9310>
    |     └ <anyio._backends._asyncio.Event object at 0x0000025061D9DC10>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000025061EC8A80>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000025061DB6350>
    |     └ <contextlib._GeneratorContextManager object at 0x0000025061D9DC40>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061D7C670>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000025061D9DBE0>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000025061D7C0D0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000025061D9DBE0>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061D7C670>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ ResponseValidationError()
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DA0040>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061D7C9D0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x0000025061DE9310>
    |     └ <anyio._backends._asyncio.Event object at 0x0000025061DE10D0>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x0000025061EC88C0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x0000025061DCFB30>
    |     └ <contextlib._GeneratorContextManager object at 0x0000025061DE10A0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061DF4820>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000025061DE1100>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000025061D71F70>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x0000025061DE1100>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061DF4820>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ ResponseValidationError()
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DF49D0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025061D7ECA0>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DF49D0>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x0000025061DDCBB0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x0000025061D76100>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025061D7ECA0>
    |           └ <function wrap_app_handling_exceptions at 0x000002506097AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x0000025061D76100>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000025061D76100>>
    |           └ <fastapi.routing.APIRouter object at 0x0000025061D76100>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x00000250609A70D0>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x0000025061D89AF0>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x0000025061DDC520>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000025061DF4D30>
    |           └ <function wrap_app_handling_exceptions at 0x000002506097AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4DC0>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x0000025061DF4D30>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x0000025061DDC520>
    |                      └ <function get_request_handler.<locals>.app at 0x0000025061D89A60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 327, in app
    |     content = await serialize_response(
    |                     └ <function serialize_response at 0x00000250609ADC10>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 176, in serialize_response
    |     raise ResponseValidationError(
    |           └ <class 'fastapi.exceptions.ResponseValidationError'>
    |
    | fastapi.exceptions.ResponseValidationError: 1 validation errors:
    |   {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}
    |
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025061...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000025061D7EC40>
          └ <fastapi.applications.FastAPI object at 0x0000025061D5DAF0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000025061D89820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000025061D7EC70>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000025061D7EC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000025061D89820>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000025...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000025061D7EC70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000025061DE9310>
    └ <anyio._backends._asyncio.Event object at 0x0000025061D9DC10>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000025061EC8A80>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000025061DB6350>
    └ <contextlib._GeneratorContextManager object at 0x0000025061D9DC40>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061D7C670>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000025061D9DBE0>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x0000025061D7C0D0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000025061D9DBE0>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061D7C670>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ ResponseValidationError()

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DA0040>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061D7C9D0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EB50>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x0000025061DE9310>
    └ <anyio._backends._asyncio.Event object at 0x0000025061DE10D0>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x0000025061EC88C0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x0000025061DCFB30>
    └ <contextlib._GeneratorContextManager object at 0x0000025061DE10A0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061DF4820>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x0000025061DE1100>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x0000025061D71F70>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x0000025061DE1100>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x0000025061DF4820>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ ResponseValidationError()

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DF49D0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025061D7ECA0>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x0000025061D7EDC0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x0000025061DF49D0>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000025061DDCBB0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000025061D76100>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000025061D7ECA0>
          └ <function wrap_app_handling_exceptions at 0x000002506097AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000025061D76100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000025061D76100>>
          └ <fastapi.routing.APIRouter object at 0x0000025061D76100>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x00000250609A70D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000025061D89AF0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4CA0>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000025061DDC520>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000025061DF4D30>
          └ <function wrap_app_handling_exceptions at 0x000002506097AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000025061DF4DC0>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x0000025061DF48B0>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000025061DF4D30>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000025061DDC520>
                     └ <function get_request_handler.<locals>.app at 0x0000025061D89A60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 327, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x00000250609ADC10>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 176, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}

2024-12-09 22:32:05.224 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'105' 0.10882329940795898
2024-12-09 22:32:36.735 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'105' 0.01753711700439453
2024-12-09 22:32:44.553 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'105' 0.012480020523071289
2024-12-09 22:33:33.170 | ERROR    | core.exception:all_exception_handler:140 - 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}

  + Exception Group Traceback (most recent call last):
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 76, in collapse_excgroups
  |     yield
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
  |     response_sent.set()
  |     │             └ <function Event.set at 0x000002D45DBA9280>
  |     └ <anyio._backends._asyncio.Event object at 0x000002D45DB59C40>
  |
  |   File "E:\workspace\zadmin\.venv\lib\site-packages\anyio\_backends\_asyncio.py", line 815, in __aexit__
  |     raise BaseExceptionGroup(
  |           └ <class 'exceptiongroup.BaseExceptionGroup'>
  |
  | exceptiongroup.ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    |     await self.app(scope, receive, _send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D45DB4B670>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000002D45DB591C0>
    |           └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D45DB591F0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D45DB4B670>
    |           │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D...
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>
    |           └ <starlette.middleware.cors.CORSMiddleware object at 0x000002D45DB591C0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000002D45DBA9280>
    |     └ <anyio._backends._asyncio.Event object at 0x000002D45DB59C40>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000002D45DC88900>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000002D45DB78350>
    |     └ <contextlib._GeneratorContextManager object at 0x000002D45DB59C70>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DB3B430>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D45DB59C10>
    |                      │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000002D45DB3B0D0>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000002D45DB59C10>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DB3B430>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ ResponseValidationError()
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DB60280>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DB3B8B0>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    |     response_sent.set()
    |     │             └ <function Event.set at 0x000002D45DBA9280>
    |     └ <anyio._backends._asyncio.Event object at 0x000002D45DBA0160>
    |
    |   File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    |     self.gen.throw(typ, value, traceback)
    |     │    │   │     │    │      └ <traceback object at 0x000002D45DC886C0>
    |     │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    |     │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    |     │    │   └ <method 'throw' of 'generator' objects>
    |     │    └ <generator object collapse_excgroups at 0x000002D45DB8FB30>
    |     └ <contextlib._GeneratorContextManager object at 0x000002D45DBA0130>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                      │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DBB5790>
    |                      │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D45DBA0190>
    |                      │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000002D45DABBF70>
    |                      └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>
    |
    |   File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    |     response = await call_next(request)
    |                      │         └ <starlette.middleware.base._CachedRequest object at 0x000002D45DBA0190>
    |                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DBB5790>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    |     raise app_exc
    |           └ ResponseValidationError()
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |           │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DBB5940>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D45DB3FD30>
    |           └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |           │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DBB5940>
    |           │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    │    └ <starlette.requests.Request object at 0x000002D45DB9CCA0>
    |           │                            │    └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>
    |           │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D45DB3FD30>
    |           └ <function wrap_app_handling_exceptions at 0x000002D45B76AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |           │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
    |           │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002D45DB340D0>>
    |           └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    |     await route.handle(scope, receive, send)
    |           │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
    |           │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │     └ <function Route.handle at 0x000002D45B7970D0>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    |     await self.app(scope, receive, send)
    |           │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
    |           │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │    └ <function request_response.<locals>.app at 0x000002D45DB4B9D0>
    |           └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |           │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
    |           │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           │                            │    └ <starlette.requests.Request object at 0x000002D45DB9C190>
    |           │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002D45DBB5CA0>
    |           └ <function wrap_app_handling_exceptions at 0x000002D45B76AA60>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |           │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5D30>
    |           │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
    |           │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
    |           └ <function request_response.<locals>.app.<locals>.app at 0x000002D45DBB5CA0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    |     response = await f(request)
    |                      │ └ <starlette.requests.Request object at 0x000002D45DB9C190>
    |                      └ <function get_request_handler.<locals>.app at 0x000002D45DB4BAF0>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 327, in app
    |     content = await serialize_response(
    |                     └ <function serialize_response at 0x000002D45B79DC10>
    |
    |   File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 176, in serialize_response
    |     raise ResponseValidationError(
    |           └ <class 'fastapi.exceptions.ResponseValidationError'>
    |
    | fastapi.exceptions.ResponseValidationError: 1 validation errors:
    |   {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}
    |
    +------------------------------------


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D45D...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D45DB591F0>
          └ <fastapi.applications.FastAPI object at 0x000002D45DB1BAC0>

> File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D45DB4B670>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000002D45DB591C0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000002D45DB591F0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000002D45DB4B670>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000002D...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x000002D45DB591C0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000002D45DBA9280>
    └ <anyio._backends._asyncio.Event object at 0x000002D45DB59C40>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000002D45DC88900>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000002D45DB78350>
    └ <contextlib._GeneratorContextManager object at 0x000002D45DB59C70>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DB3B430>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D45DB59C10>
                     │    └ <function register_jwt_refresh_middleware.<locals>.jwt_refresh_middleware at 0x000002D45DB3B0D0>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>

  File "E:\workspace\zadmin\core\middleware.py", line 53, in jwt_refresh_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002D45DB59C10>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DB3B430>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ ResponseValidationError()

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DB60280>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DB3B8B0>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3FB20>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 189, in __call__
    response_sent.set()
    │             └ <function Event.set at 0x000002D45DBA9280>
    └ <anyio._backends._asyncio.Event object at 0x000002D45DBA0160>

  File "D:\tool\python\lib\contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
    │    │   │     │    │      └ <traceback object at 0x000002D45DC886C0>
    │    │   │     │    └ ExceptionGroup('unhandled errors in a TaskGroup', [ResponseValidationError()])
    │    │   │     └ <class 'exceptiongroup.ExceptionGroup'>
    │    │   └ <method 'throw' of 'generator' objects>
    │    └ <generator object collapse_excgroups at 0x000002D45DB8FB30>
    └ <contextlib._GeneratorContextManager object at 0x000002D45DBA0130>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_utils.py", line 82, in collapse_excgroups
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 187, in __call__
    response = await self.dispatch_func(request, call_next)
                     │    │             │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DBB5790>
                     │    │             └ <starlette.middleware.base._CachedRequest object at 0x000002D45DBA0190>
                     │    └ <function register_request_log_middleware.<locals>.request_log_middleware at 0x000002D45DABBF70>
                     └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>

  File "E:\workspace\zadmin\core\middleware.py", line 37, in request_log_middleware
    response = await call_next(request)
                     │         └ <starlette.middleware.base._CachedRequest object at 0x000002D45DBA0190>
                     └ <function BaseHTTPMiddleware.__call__.<locals>.call_next at 0x000002D45DBB5790>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 163, in call_next
    raise app_exc
          └ ResponseValidationError()

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\base.py", line 149, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
          │    │   │      │                      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DBB5940>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D45DB3FD30>
          └ <starlette.middleware.base.BaseHTTPMiddleware object at 0x000002D45DB3F700>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.send_no_error at 0x000002D45DBB5940>
          │                            │    │    │     │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x000002D45DB9CCA0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000002D45DB3FD30>
          └ <function wrap_app_handling_exceptions at 0x000002D45B76AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
          │    │                │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000002D45DB340D0>>
          └ <fastapi.routing.APIRouter object at 0x000002D45DB340D0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
          │     │      │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │     └ <function Route.handle at 0x000002D45B7970D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
          │    │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │    └ <function request_response.<locals>.app at 0x000002D45DB4B9D0>
          └ APIRoute(path='/user/lists', name='用户列表', methods=['GET'])

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5C10>
          │                            │    │        │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x000002D45DB9C190>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000002D45DBB5CA0>
          └ <function wrap_app_handling_exceptions at 0x000002D45B76AA60>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000002D45DBB5D30>
          │   │      └ <function BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.receive_or_disconnect at 0x000002D45DBB5820>
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8081), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x000002D45DBB5CA0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x000002D45DB9C190>
                     └ <function get_request_handler.<locals>.app at 0x000002D45DB4BAF0>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 327, in app
    content = await serialize_response(
                    └ <function serialize_response at 0x000002D45B79DC10>

  File "E:\workspace\zadmin\.venv\lib\site-packages\fastapi\routing.py", line 176, in serialize_response
    raise ResponseValidationError(
          └ <class 'fastapi.exceptions.ResponseValidationError'>

fastapi.exceptions.ResponseValidationError: 1 validation errors:
  {'type': 'string_type', 'loc': ('response', 'data', 0, 'created_at'), 'msg': 'Input should be a valid string', 'input': datetime.datetime(2024, 12, 9, 21, 35, 9)}

2024-12-09 22:35:39.216 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'140' 0.1048126220703125
2024-12-09 22:36:46.421 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 200utf-8 b'140' 0.1931605339050293
2024-12-09 22:51:09.947 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/lists?page=1&limit=10&v_order_field=id&v_order=desc http/1.1' 404utf-8 b'22' 0.0010056495666503906
2024-12-09 22:51:26.606 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0006268024444580078
2024-12-09 22:51:26.913 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'5751' 0.026992321014404297
2024-12-09 23:11:17.199 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.07248163223266602
2024-12-09 23:11:40.603 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.05197262763977051
2024-12-09 23:12:01.009 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.000997781753540039
2024-12-09 23:12:04.468 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0009980201721191406
2024-12-09 23:12:25.964 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/docs http/1.1' 200utf-8 b'930' 0.0009374618530273438
2024-12-09 23:12:38.634 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/openapi.json http/1.1' 200utf-8 b'5751' 0.06334996223449707
2024-12-09 23:12:52.607 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'POST http://127.0.0.1:8081/user/api/login http/1.1' 200utf-8 b'186' 0.8072218894958496
2024-12-09 23:12:58.459 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/?page=1&limit=10 http/1.1' 200utf-8 b'140' 0.02329540252685547
2024-12-09 23:13:21.887 | INFO     | core.middleware:write_request_log:24 - basehttp.log_message: 'GET http://127.0.0.1:8081/user/?page=1&limit=10 http/1.1' 200utf-8 b'140' 0.011990547180175781
